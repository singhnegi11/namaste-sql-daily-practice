ðŸ”¹ Correlated subquery
A subquery that references a column from the outer query.
Because of that reference, the database cannot execute it independently.


  select emp_id,salary,department from employee e1
where salary > (select avg(salary) from employee e2
			   where e1.department <> e2.department);


----cross join 
A CROSS JOIN is a type of SQL join that produces the Cartesian product of two tables.
Simply put:

âœ… Every row from the first table is combined with every row from the second table

There is no join condition.
Explicit CROSS JOIN


SELECT *
FROM table1
CROSS JOIN table2

---- roll over for aggreagarte function


with cte as (select transaction_date,avg(transaction_amount) as aov from transactions
group by transaction_date),
cte2 as (select transaction_date,aov,min(aov) over() as min, max(aov) over () as max from cte )
select ct2.transaction_date,ct2.aov,round((ct2.max-ct2.min),2) as diff_from_highest_aov from cte2 ct2
where ct2.aov=ct2.min

---- we can use aggregate fucntion with group by , in that case all rows are considered as single group and we get aggreagted result as one row in o/p 
In SQL, when you use an aggregate function (like SUM, COUNT, AVG, etc.) without a GROUP BY, the database treats the entire result set as a single implicit group and returns one row.
SUM(...) is an aggregate over all rows from cte, hence it returns a single scalar.
You donâ€™t need GROUP BY unless you want multiple groups (e.g., count per location_id, per emp_id, per day, etc.).


Think of it like:

No GROUP BY â‡’ one big group â‡’ one aggregated result row.


with cte as (select *,lead(created_at) over (partition by emp_id order by created_at) as date from employee_record )
select sum(case when '2019-04-01 19:05:00' between ct.created_at and ct.date then 1 else 0 end ) 
 as no_of_emp_inside from cte ct;

